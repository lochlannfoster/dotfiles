#!/bin/bash
# setup_symlinks.sh
# Script to set up symbolic links for configuration files
# Usage: ./setup_symlinks.sh /path/to/your/repo

# Check if repository path is provided
if [ $# -ne 1 ]; then
    echo "Usage: $0 /path/to/your/repo"
    exit 1
fi

REPO_PATH="$1"

# Function to create symbolic links
create_symlink() {
    local source="$REPO_PATH/$1"
    local target="$HOME/$2"
    
    # Check if source file exists
    if [ ! -f "$source" ]; then
        echo "Error: Source file $source does not exist!"
        return 1
    fi
    
    # Remove existing file/symlink if it exists
    if [ -e "$target" ] || [ -L "$target" ]; then
        echo "Removing existing file: $target"
        rm -f "$target"
    fi
    
    # Create directory if it doesn't exist
    local target_dir=$(dirname "$target")
    if [ ! -d "$target_dir" ]; then
        echo "Creating directory: $target_dir"
        mkdir -p "$target_dir"
    fi
    
    # Create the symbolic link
    echo "Creating symlink: $source -> $target"
    ln -s "$source" "$target"
}

# Start setup
echo "Setting up symlinks from repository: $REPO_PATH"

# Shell configuration files
create_symlink ".bash_profile" ".bash_profile"
create_symlink ".bashrc" ".bashrc"

# Alacritty configuration
create_symlink ".config/alacritty/alacritty.yml" ".config/alacritty/alacritty.yml"

# i3 configuration
create_symlink ".config/i3/config" ".config/i3/config"

# i3blocks configuration
create_symlink ".config/i3blocks/config5" ".config/i3blocks/config"

# i3blocks scripts
create_symlink ".config/i3blocks_battery.sh" ".config/i3blocks/i3blocks_battery.sh"
create_symlink ".config/i3blocks_memory.sh" ".config/i3blocks/i3blocks_memory.sh"
create_symlink ".config/i3blocks_wireless.sh" ".config/i3blocks/i3blocks_wireless.sh"
create_symlink ".config/i3blocks_workspaces.sh" ".config/i3blocks/i3blocks_workspaces.sh"

# Make the scripts executable
echo "Making scripts executable..."
chmod +x "$HOME/.config/i3blocks/i3blocks_battery.sh"
chmod +x "$HOME/.config/i3blocks/i3blocks_memory.sh"
chmod +x "$HOME/.config/i3blocks/i3blocks_wireless.sh"
chmod +x "$HOME/.config/i3blocks/i3blocks_workspaces.sh"

echo "Setup complete! Please restart i3 with Mod+Shift+r to apply changes."
